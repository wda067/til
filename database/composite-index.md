# 복합 인덱스

## 인덱스는 순서대로 사용한다.

  - 인덱스를 `(A, B, C)` 순서로 생성했다면 가령 `(B, C)` 순서로 `WHERE` 조건에 사용하면 인덱스를 사용할 수 없다.

## 등호 조건은 앞으로, 범위 조건은 뒤로

- 복합 인덱스에서 **어떤 컬럼에 범위 검색을 사용하는 순간, 그 뒤에 오는 컬럼들은 인덱스의 정렬 효과를 제대로 누릴 수 없게 된다.**

### IN 절

- 만약 범위 조건 때문에 두 번째 인덱스 컬럼을 활용하지 못하는 이 문제는, `>`나 `<`같은 범위 대신 **`IN` 절을 사용**함으로써 해결할 수 있는 경우가 많다.
- 아래 두 쿼리는 동일한 결과값을 가지는데 `>`는 '연속된 범위'로 처리되어 복합 인덱스의 추가적인 활용을 막는 반면, `IN`은 '여러 개의 개별 지점'에 대한 **동등(`=`) 비교의 묶음으로 처리**된다.
    ```sql
    SELECT * FROM items WHERE category >= '패션' AND price = 20000;
    SELECT * FROM items WHERE category IN ('패션', '헬스/뷰티') AND price = 20000;
    ```

## 정렬도 인덱스 순서를 따른다.

- `ORDER BY` 절이 인덱스 컬럼 순서와 일치하면, 데이터베이스는 이미 정렬된 인덱스를 순서대로 읽기만 하면 되므로 매우 빠르다. 
- 이 경우 실행 계획에서 `Using filesort`가 사라지는 것을 볼 수 있다.
